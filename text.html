<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>社区任务</title>
</head>

<body>
  <h1>社区任务</h1>
  <button id="dailyCheckIn">每日签到</button>
  <button id="weeklyCheckIn">每周签到</button>

  <script>
    document.addEventListener("DOMContentLoaded", function () {
      // 获取存储的用户信息
      const userData = JSON.parse(localStorage.getItem('userData')) || [];

      // 获取签到按钮
      const dailyCheckInBtn = document.getElementById('dailyCheckIn');
      const weeklyCheckInBtn = document.getElementById('weeklyCheckIn');

      // 模拟已登录用户
      const loggedInUser = userData.find(user => user.logSta === 1);

      if (loggedInUser) {
        // 获取当前时间
        const currentDate = new Date().getDate();

        dailyCheckInBtn.addEventListener('click', function () {
          if (loggedInUser.lastDailyCheckIn !== currentDate) {
            loggedInUser.integralnub += 5;
            loggedInUser.lastDailyCheckIn = currentDate;
            updateLocalStorage(userData);
            alert('每日签到成功！积分增加5');
          } else {
            alert('今天已经签到过了！');
          }
        });

        weeklyCheckInBtn.addEventListener('click', function () {
          if (loggedInUser.lastWeeklyCheckIn !== currentDate) {
            loggedInUser.integralnub += 15;
            loggedInUser.lastWeeklyCheckIn = currentDate;
            updateLocalStorage(userData);
            alert('每周签到成功！积分增加15');
          } else {
            alert('本周已经签到过了！');
          }
        });
      } else {
        alert('请先登录！');
        // 如果用户未登录，可进行登录跳转等操作
      });

      // 更新本地存储的用户数据
      function updateLocalStorage(data) {
        localStorage.setItem('userData', JSON.stringify(data));
      }
    </script>
</body>

</html>
